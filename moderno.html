<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>FundaTerm — Modo Moderno</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg: #070a0f;
      --bg2:#0c1220;
      --fg: #e6f3ff;
      --muted:#a7b4c6;
      --primary: #7dd3fc;
      --accent: #a78bfa;
      --ok: #34d399;
      --err:#ff6961;
      --glass: rgba(255,255,255,0.06);
      --border: rgba(255,255,255,0.14);
      --glow: 0 0 24px rgba(124, 58, 237, .35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--fg);
      background:
        radial-gradient(1200px 600px at 10% 10%, #0b1221 0%, transparent 60%),
        radial-gradient(1000px 500px at 90% 90%, #0b1a2e 0%, transparent 60%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
      font: 16px/1.45 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      overflow:hidden;
    }
    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      height:100%;
      display:grid;
      grid-template-rows: auto 1fr auto;
      gap: 14px;
      padding: 18px 14px;
    }
    header{
      display:flex; align-items:center; justify-content:space-between;
    }
    .brand{
      display:flex; align-items:center; gap:10px; letter-spacing:.02em;
      text-shadow: 0 0 24px rgba(125,211,252,.25);
    }
    .badge{
      padding:2px 8px; border:1px solid var(--border); border-radius:12px; background:var(--glass);
      color:var(--primary);
    }

    .panel{
      height:100%;
      border: 1px solid var(--border);
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), var(--glow);
      display:grid; grid-template-rows: 1fr auto; overflow: hidden;
      backdrop-filter: blur(10px);
    }
    /* chat area */
    .chat{
      padding: 16px;
      overflow:auto;
      display:flex; flex-direction:column; gap:12px;
    }
    .msg{
      display:flex; gap:10px; align-items:flex-start;
      max-width: 920px;
      animation: rise .16s ease-out both;
    }
    @keyframes rise{ from{transform:translateY(6px); opacity:0} to{transform:none; opacity:1} }
    .msg.user .bubble{
      margin-left:auto; border:1px solid rgba(125,211,252,.35);
      background: linear-gradient(180deg, rgba(125,211,252,.12), rgba(125,211,252,.06));
    }
    .msg.bot .bubble{
      border:1px solid rgba(167,139,250,.35);
      background: linear-gradient(180deg, rgba(167,139,250,.12), rgba(167,139,250,.06));
    }
    .bubble{
      padding: 12px 14px; border-radius: 14px; white-space: pre-wrap; word-break: break-word;
    }
    .muted{ color:var(--muted) }

    /* input */
    .composer{
      border-top:1px solid var(--border);
      padding: 12px; display:flex; gap:10px; align-items:center; background: rgba(10,14,22,.4);
    }
    .prompt{
      flex:1; display:flex; align-items:center; gap:10px;
      padding:10px 12px; border:1px solid var(--border); border-radius: 12px;
      background: rgba(255,255,255,0.04);
    }
    .caret{ color:var(--accent); opacity:.9 }
    #input{
      flex:1; outline:none; border:none; background:transparent; color:var(--fg);
    }
    .hint{ font-size:.9rem }
    .chipbar{ display:flex; flex-wrap:wrap; gap:8px; margin-top:6px }
    .chip{
      border:1px solid var(--border); background:var(--glass); padding:6px 10px; border-radius:10px;
      cursor:pointer; user-select:none;
    }
    .chip:hover{ border-color: rgba(255,255,255,.35) }

    /* loader cursor */
    .cursor{
      display:inline-block; width:8px; height:1em; background: currentColor; opacity:1; margin-left:3px;
      animation: blink 1s steps(1) infinite;
    }
    @keyframes blink { 50%{opacity:0} }

    /* entrance glitch-ish */
    .fx-enter{
      position:fixed; inset:0; pointer-events:none; backdrop-filter: blur(0px);
      opacity:0; transform: scale(1.02);
      background: radial-gradient(1200px 300px at 50% 0%, rgba(124,58,237,.08), transparent 70%);
      animation: enter .9s ease-out both;
    }
    @keyframes enter{ 
      0%{opacity:0; transform:scale(1.02)}
      20%{opacity:.6}
      100%{opacity:0; transform:none}
    }

    @media (max-width:700px){
      .wrap{ padding:12px 10px }
      .composer{ padding:10px }
    }
  </style>
</head>
<body>
  <div class="fx-enter"></div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="badge">FundaTerm · Moderno</div>
        <div class="muted">Aprendizaje de Fundamentos de Programación</div>
      </div>
      <div class="muted hint">Escribe un tema o <strong>help</strong>. Tab = autocompletar · Enter = enviar</div>
    </header>

    <section class="panel">
      <div id="chat" class="chat" role="log" aria-live="polite"></div>

      <div class="composer">
        <div class="caret">&gt;</div>
        <input id="input" type="text" placeholder="Escribe: area problematica, objetivos, antecedentes, resultados esperados, metodologia, bibliografia…" autocomplete="off" />
        <button id="send" title="Enviar (Enter)" style="border:1px solid var(--border); background:var(--glass); color:var(--fg); border-radius:10px; padding:8px 10px">Enviar</button>
      </div>
    </section>

    <div class="chipbar" id="chips"></div>
  </div>

  <script>
    // ======= Configuración de rutas (cámbialas si tus archivos tienen otros nombres) =======
    const ROUTES = {
      "area problematica": "area_problematica.html",
      "objetivos": "objetivos.html",
      "antecedentes": "antecedentes.html",
      "resultados esperados": "resultados_esperados.html",
      "metodologia": "metodologia.html",
      "bibliografia": "bibliografia.html",
    };

    // ======= Utilidades =======
    const chat = document.getElementById('chat');
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('send');
    const chips = document.getElementById('chips');

    const COMMANDS = Object.keys(ROUTES);
    const HELP_TEXT =
`Comandos disponibles:
- area problematica
- objetivos
- antecedentes
- resultados esperados
- metodologia
- bibliografia

Atajos:
- help : muestra esta ayuda
- menu : lista comandos como chips
- clear: limpia la conversación

Tip: Usa Tab para autocompletar. Ctrl+Enter abre en una pestaña nueva.`;

    function norm(s){
      return (s || "")
        .toString()
        .trim()
        .toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'') // sin acentos
        .replace(/\s+/g, ' ');
    }

    function scrollToEnd(){
      chat.scrollTop = chat.scrollHeight;
    }

    function addMessage(text, who="bot"){
      const wrap = document.createElement('div');
      wrap.className = `msg ${who}`;
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.textContent = text;
      wrap.appendChild(bubble);
      chat.appendChild(wrap);
      scrollToEnd();
    }

    function addTyping(){
      const wrap = document.createElement('div');
      wrap.className = 'msg bot';
      wrap.dataset.typing = "1";
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.innerHTML = `Pensando<span class="cursor"></span>`;
      wrap.appendChild(bubble);
      chat.appendChild(wrap);
      scrollToEnd();
      return wrap;
    }

    function removeTyping(node){
      if(node && node.parentNode) node.parentNode.removeChild(node);
    }

    function showChips(){
      chips.innerHTML = "";
      COMMANDS.forEach(cmd=>{
        const b = document.createElement('div');
        b.className = 'chip';
        b.textContent = cmd;
        b.onclick = ()=> navigate(cmd);
        chips.appendChild(b);
      });
    }

    function autocomplete(value){
      const v = norm(value);
      if(!v) return "";
      const hit = COMMANDS.find(c => norm(c).startsWith(v));
      return hit || "";
    }

    function routeFor(command){
      const key = COMMANDS.find(c => norm(c) === norm(command));
      return key ? ROUTES[key] : null;
    }

    function navigate(command){
      const dst = routeFor(command);
      if(dst){
        // pequeño feedback antes de ir
        const t = addTyping();
        setTimeout(()=>{
          removeTyping(t);
          window.location.href = dst;
        }, 250);
      }else{
        addMessage('No reconozco ese comando. Escribe "help" o "menu".', 'bot');
      }
    }

    // ======= Lógica de entrada =======
    function handleSubmit(){
      const raw = input.value;
      if(!raw.trim()) return;

      addMessage(raw, 'user');
      input.value = "";

      const cmd = norm(raw);

      if(cmd === 'help'){
        addMessage(HELP_TEXT, 'bot');
        return;
      }
      if(cmd === 'menu'){
        showChips();
        addMessage('Selecciona una opción o escríbela y presiona Enter.', 'bot');
        return;
      }
      if(cmd === 'clear'){
        chat.innerHTML = "";
        return;
      }

      // alias/variantes comunes
      const aliases = {
        "area problemática": "area problematica",
        "area-problematica": "area problematica",
        "resultados": "resultados esperados",
        "metodología": "metodologia",
        "bibliografía": "bibliografia",
      };
      const resolved = aliases[raw.toLowerCase()] || raw;

      const dst = routeFor(resolved);
      if(dst){
        const t = addTyping();
        setTimeout(()=>{ removeTyping(t); window.location.href = dst; }, 220);
      }else{
        // sugerencias por similitud simple (startsWith)
        const sugg = COMMANDS.filter(c => norm(c).startsWith(cmd.split(' ')[0])).slice(0,3);
        addMessage(sugg.length
          ? `¿Quisiste decir: ${sugg.join(' · ')} ?\nEscribe uno de ellos o usa "help".`
          : 'Comando no encontrado. Prueba con "help" o "menu".', 'bot');
      }
    }

    // Eventos
    sendBtn.addEventListener('click', handleSubmit);
    input.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){
        if(e.ctrlKey || e.metaKey){
          // Ctrl+Enter abre en una pestaña nueva si es un comando válido
          const dst = routeFor(input.value);
          if(dst){ window.open(dst, '_blank'); }
          e.preventDefault();
          return;
        }
        e.preventDefault(); handleSubmit();
      }else if(e.key === 'Tab'){
        const ac = autocomplete(input.value);
        if(ac){
          input.value = ac;
          requestAnimationFrame(()=> input.setSelectionRange(ac.length, ac.length));
          e.preventDefault();
        }
      }
    });

    // Mensajes iniciales
    addMessage('Bienvenido a code AI.\nEnfocado en aprendizaje de fundamentos de programación.', 'bot');
    addMessage('Escribe "help" para ver los comandos o "menu" para ver opciones rápidas.', 'bot');
    showChips();
    input.focus();
    document.addEventListener('click', ()=> input.focus(), false);
  </script>
</body>
</html>
